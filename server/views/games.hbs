{{!< main}}
<div class="row contentbox">
  <div class="large-12 columns">
    <h3 style="float: left; width: 50%">Mine spill</h3>
    <br>
    <input id="new-game-button" type="submit" value="Nytt spill" class="button small" style="float: right;" />
    <div id="error" {{#if error}} class="error" {{/if}}>{{error}}</div>
    <table class="large-12 columns">
      <thead>
          <tr>
              <td class="top-left">Spill-id</td>
              <td>Navn</td>
              <td>Laget</td>
              <td></td>
              <td></td>
              <td></td>
          </tr>
      </thead>
      <tbody>
        {{#each games}}
          <tr>
            <td id="game-id">
              {{gameId}}
            </td>
            <td>
              <ul class="button-group">
                <label for="edit-game-name-button">{{name}}</label>
                <input id="edit-game-name-button" type="submit" value="Rediger" class="button tiny success edit-game-name" style="float: right;"/>
              </ul>
              <!-- <div class="control-group">
                <div class="control-label" style="float: left; vertical-align: middle; width: 70%">
                  {{name}}
                </div>
                <input type="text" value="{{name}}" class="edit-input" style="display: none; float: left; width: 70%;" />
                <div class="controls" style="float: right; width: 30% text-align: right;">
                  <a class="editSave" href="#">Rediger</a>
                </div>
              </div> -->
            </td>
            <td>
              {{datetimeformat created}}
            </td>
            <td>
              <ul class="button-group">
                <input id="delete-game-button" type="submit" value="Rediger" class="button small success edit-game" />
              </ul>
            </td>
            <td>
              <ul class="button-group">
                <input id="delete-game-button" type="submit" value="Spill" class="button small play-game" />
              </ul>
            </td>
            <td>
              <ul class="button-group">
                <input id="delete-game-button" type="submit" value="Slett" class="button small secondary delete-game" />
              </ul>
            </td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  </div>
</div>

<div id="new-game-dialog" title="Nytt spill">
  <form id="new-game" action="/game" method="POST" name="new-game">
    <label>Navn på nytt spill:</label>
    <input type="text" name="name" id="name" />
  </form>
</div>

<div id="delete-game-dialog">
  <form id="delete-game" method="POST" name="delete-game">
    <label>Er du sikker på at du vil slette spillet?</label>
  </form>
</div>

<div id="edit-game-name-dialog">
  <form id="edit-game-name" method="POST" name="edit-game-name">
    <label>Nytt navn:</label>
    <input type="text" name="name" id="name" />
  </form>
</div>

<script type="text/javascript">

$(document).ready(function() {

  $( '#new-game-dialog' ).dialog({
    autoOpen: false,
    height: 300,
    width: 300,
    modal: true,
    buttons: {
      'OK': function (){
        document.forms[ 'new-game' ].submit();
      },
      'Avbryt': function (){
        $( this ).dialog( 'close' );
      }
    },
  });

  $( '#delete-game-dialog' ).dialog({
    autoOpen: false,
    height: 300,
    width: 300,
    modal: true,
    buttons: {
      'Slett': function (){
        document.forms[ 'delete-game' ].submit();
      },
      'Avbryt': function (){
        $( this ).dialog( 'close' );
      }
    }
  });

  $( '#edit-game-name-dialog' ).dialog({
    autoOpen: false,
    height: 300,
    width: 300,
    modal: true,
    buttons: {
      'Lagre': function (){
        document.forms[ 'edit-game-name' ].submit();
      },
      'Avbryt': function (){
        $( this ).dialog( 'close' );
      }
    }
  });

  $( '#new-game-button' ).click( function () {
    $( '#new-game-dialog' ).dialog( 'open' );
  });

  $( '.edit-game-name' ).click( function (){
    var button = $(this);
    var row = button.parent().parent().parent();
    var gameId = parseInt( row.find( '#game-id' ).html() );

    $( '#edit-game-name' ).attr( 'action', '/game/' + gameId );
    $( '#edit-game-name-dialog' ).dialog( 'open' );
  });

  $( '.edit-game' ).click( function (){
    var button = $(this);
    var row = button.parent().parent().parent();
    var gameId = parseInt( row.find( '#game-id' ).html() );

    window.location.href = '/game/' + gameId;
  });

  $( '.play-game' ).click( function (){
    var button = $(this);
    var row = button.parent().parent().parent();
    var gameId = parseInt( row.find( '#game-id' ).html() );

    window.location.href = '/play/' + gameId;
  });

  $( '.delete-game' ).click( function (){
    var button = $(this);
    var row = button.parent().parent().parent();
    var gameId = parseInt( row.find( '#game-id' ).html() );

    $( '#delete-game' ).attr( 'action', '/deletegame/' + gameId );
    $( '#delete-game-dialog' ).dialog( 'open' );
  });
});

</script>
